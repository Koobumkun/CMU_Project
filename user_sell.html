<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Sell</title>
  <link rel="stylesheet" href="user_sell.css">
</head>

<body>
  <div class="container">
    <!-- Sidebar -->
    <div class="sidebar">
      <!-- Logo Section -->
      <div class="logo-section">
        <h2>&nbsp;Recycle Battery</h2>
      </div>

      <!-- Menu Section -->
      <div class="sidebar-header">
        <img src="https://via.placeholder.com/100" alt="User Avatar" class="user-avatar">
        <h3>Username</h3>
        <nav class="sidebar-nav">
          <ul>
            <li>
              <a href="./user_dashboard.html">
                <img src="./images/dashboard.png" />
                Dashboard
              </a>
            </li>
            <li>
              <a href="./user_sell.html
              ">
                <img src="./images/sell.png" />
                Sell
              </a>
            </li>
          </ul>
        </nav>
      </div>
    </div>

    <!-- Main Content -->
    <main class="main-content">
      <h1>Sell</h1>

      <!-- Sell History -->
      <section id="sell-history">
        <h3>판매 신청 내역</h3>
        <table>
          <thead>
            <tr>
              <th>Status</th>
              <th>Type</th>
              <th>Date</th>
              <th>Cost</th>
            </tr>
          </thead>
          <tbody id="sell-list"></tbody>
        </table>
      </section>

      <!-- Selling Form -->
      <section id="selling-form">
        <h3>Selling Form</h3>
        <form>
          <div class="form-group">
            <label for="battery-type">Type of Battery</label>
            <select id="battery-type">
              <option>Lithium AAA</option>
              <option>Alkaline AA</option>
              <option>Nickel-Cadmium</option>
            </select>
          </div>
          <div class="form-group">
            <label for="amount">수량? amount?</label>
            <input type="number" id="amount" placeholder="Enter amount">
          </div>
          <div class="form-group">
            <p>예상 판매가</p>
            <h2 id="price"></h2>
          </div>
          <button type="submit" class="submit-button">Applying to sell</button>
        </form>
      </section>
    </main>
  </div>
  <script>
    document.getElementById("amount").addEventListener("input", function () {
      const amount = parseInt(this.value, 10) || 0; // 입력된 수량
      const type = document.getElementById("battery-type").value; // 배터리 타입 선택값
      let pricePerUnit = 0;

      // 배터리 타입별 단가 설정
      if (type === "Lithium AAA") {
        pricePerUnit = 100;
      } else if (type === "Alkaline AA") {
        pricePerUnit = 80;
      } else {
        pricePerUnit = 60;
      }

      // 총 가격 계산 및 표시
      const totalPrice = amount * pricePerUnit;
      document.getElementById("price").textContent = `${totalPrice}$`;
    });

    const sellHistory = [];

    // 폼 요소 가져오기
    const form = document.getElementById("selling-form");
    const historyBody = document.getElementById("sell-list");

    // 폼 제출 이벤트
    form.addEventListener("submit", function (e) {
      e.preventDefault(); // 폼 기본 동작 방지

      // 입력 값 가져오기
      const type = document.getElementById("battery-type").value;
      const amount = parseInt(document.getElementById("amount").value, 10);
      const price = parseInt(document.getElementById("price").textContent, 10);

      // 현재 날짜 생성
      const date = new Date().toLocaleDateString();

      // 새로운 항목 추가
      const newItem = {
        status: "⏳ Waiting",
        type,
        amount,
        date,
        cost: `${price}$`
      };

      // 배열에 추가
      sellHistory.push(newItem);

      // 테이블 업데이트
      updateTable();
    });

    // 테이블 업데이트 함수
    function updateTable() {
      // 테이블 초기화
      historyBody.innerHTML = "";

      // 배열의 항목을 테이블에 추가
      sellHistory.forEach((item) => {
        const row = document.createElement("tr");

        row.innerHTML = `
          <td>${item.status}</td>
          <td>${item.type}</td>
          <td>${item.amount}</td>
          <td>${item.date}</td>
          <td>${item.cost}</td>
        `;

        historyBody.appendChild(row);
      });
    }
  </script>

</body>

</html>